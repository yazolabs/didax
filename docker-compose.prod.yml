services:
  mysql:
  environment:
    MYSQL_DATABASE: didax_db
    MYSQL_USER: didax
    MYSQL_PASSWORD: didax_pass
    MYSQL_ROOT_PASSWORD: root_pass

backend:
  environment:
    DB_NAME: didax_db


  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile.prod
    environment:
      NODE_ENV: production
      DB_HOST: mysql
      DB_PORT: "3306"
      DB_NAME: didax
      DB_USER: didax
      DB_PASS: didax_pass
      CORS_ORIGIN: https://didax.yazolabs.com.br
    depends_on:
      mysql:
        condition: service_healthy

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.prod
      args:
        VITE_API_URL: https://api.didax.yazolabs.com.br
    depends_on:
      - backend

volumes:
  mysql_data:
